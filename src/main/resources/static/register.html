<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/stile.css" type = "text/css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <script src="js/animal.js"></script>
    <script src = "js/loadTable.js"></script>
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    <title>Registro dati</title>
	<script>
		$(function(){
			$("#navbar").load("header.html");
		});
  </script>
</head>
<body>
<div id= navbar></div>
<div class="contorno" style="background-image: url('img/bg_1.jpg');">
  <div class="container">
    <div class="row no-gutters slider-text align-items-center justify-content-center">
      <div class="col-md-9 ftco-animate text-center">
        <h1 class="mb-0 bread">Registro dati</h1>
      </div>
    </div>
  </div>
</div>

<hr>


<div class="container">
    <!-- Search form -->
    <form class="form-inline d-flex justify-content-left md-form form-sm mt-0" id="ricerca">
        <i class="fas fa-search" aria-hidden="true"></i>
        <input class="form-control form-control-sm ml-3 " type="text" placeholder="Inserisci nome animale"
        aria-label="Search" name="srch" style="width: 70%; margin-right: 8px;">
        <button id="cerca" type="submit" class="form-control form-control" > Cerca</button>
        <span><button id="cerca" type="submit" class="form-control form-control" > Aggiungi Nuovo Animale</button></span>
    </form><br>
    
    <table id="register" class="table table-striped">
      <thead>
        <tr>
          <th name="gps">Codice Gps</th>
          <th name="name">Nome</th>
          <th name="type">Tipo</th>
		  <th name="info">Info</th>
		  <th name="modify">Modifica</th>
          <th name="delete">Elimina</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
  </div>
  <div class="container">
    <ul class="pagination justify-content-center">
      <li class="page-item disabled"><a class="page-link" href="#">Pagina</a></li>
      
    </ul>
  </div>

<!--Modal per icona info -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" style="margin-top: 250px;">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <!--Header-->
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">New message</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <!--body-->
      <div class="modal-body">
        <label><strong>Codice GPS:</strong>  </label>
        <label id = "gps"></label><br>
        <label><strong>Nascita:</strong>  </label>
        <label id="bday"></label><br>
        <label><strong>Tipo:</strong> </label>
        <label id = "type"></label><br>
        <label><strong>Sesso:</strong> </label>
        <label id = "sex"></label><br>
        <label><strong>Latte prodotto:</strong> </label>
        <label id = "milk"></label><br>
        <label><strong>Numero Parti:</strong> </label>
        <label id= "children"></label><br>
      </div>
        <!--footer-->
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Chiudi</button>
        </div>
      </div>
    </div>
  </div>

<script>
$('document').ready(function() {
  //getAnimal
  var register = new Register();
  loader("register",register.registerData());

  $('#exampleModal').on('show.bs.modal', function (event) {
  var button = $(event.relatedTarget) // Button that triggered the modal
  var gps = button.data('whatever') // Extract info from data-* attributes
  // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
  // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
  var modal = $(this)
  var animal = register.getAnimal(gps)

  modal.find('.modal-title').text(animal.name)
  modal.find('.modal-body #name').append(animal.name)
  modal.find('.modal-body #gps').append(animal.tracker)
  modal.find('.modal-body #bday').append(animal.bday)
  modal.find('.modal-body #type').append(animal.type)
  modal.find('.modal-body #sex').append(animal.sex)
  modal.find('.modal-body #milk').append(animal.lmilk)
  modal.find('.modal-body #children').append(animal.children)
});

//
$('#exampleModal').on('hidden.bs.modal', function (event) {
  var modal = $(this)

  modal.find('.modal-title').text("")
  modal.find('.modal-body #name').html("")
  modal.find('.modal-body #gps').html("")
  modal.find('.modal-body #bday').html("")
  modal.find('.modal-body #type').html("")
  modal.find('.modal-body #sex').html("")
  modal.find('.modal-body #milk').html("")
  modal.find('.modal-body #children').html("")
});


$('#ricerca').submit(function(e){
        //fare un filter su elementi che possiedono nell'html una substring del nome dell'animale
        let list = register.registerData()
        let page = []
        $('#register tbody tr').remove()
      
        list.forEach(e =>{
            let str = e.name
            let srch = $('input[name = "srch"]').val()
           
            if(str.indexOf(srch)>=0){
                page.push(e)
            }
        });

        loader("register", page)
        return false
        //dobbiamo ricorda che possiamo avere solo 10 elementi per pagin
    });
 });
</script>
</body>
</html>